# 网络通信五层结构
> Node提供了net, dgram, http, https分别用于处理TCP, UDP, HTTP, HTTPS，适用于服务器端和客户端

## 网络七层模型
![网络七层模型](./assets/%E7%BD%91%E7%BB%9C%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B.png)
### 1.链路层
以太网规定，连入网络的所有设备，都必须具有“网卡”接口，数据包必须从一块网卡，传到另一块网卡。网卡的地址，就是数据包的发送地址和接收地址，即**MAC地址**; 有了MAC地址，可以定位网卡和数据包的路径
> 一块网卡怎么知道另一块网卡的MAC地址
> 答：以太网采用“原始”的方式，不是把数据包准确送到接收方，而是向本网络内所有计算机发送(广播)，让每台计算机自己判断(通过包的标头找到接收方的MAC地址，与自身的MAC地址比较)，是否为接收方.

### 2.网络层
引进一套新的地址，能够区分不同的计算机是否属于同一个自网络，即“网络地址”，简称**网址**

网络地址能帮助确认计算机所在的子网络，MAC地址则将数据包送到孩子网络中的目标网卡。从逻辑上就可知先处理网络地址再缩小范围处理MAC地址。

- IP协议：规定网络地址的协议，目前广泛使用的是IPv4——网络地址由32个二进制位组成，从0.0.0.0一直到255.255.255.255

### 3.传输层
有了MAC地址和IP地址，可以在互联网上任意两台主机上建立通信，但一台主机上有许多程序都需要用到网络，使用端口号用于区分不同应用的数据。

每个数据包都发送到主机上特定的端口，所以不同的程序就能获取到自己所需要的数据。

端口是0到65535之间的一个整数，正好16个二进制位。0到1023的端口被系统占用，用户只能选择大于1023的端口。应用程序会随机选用一个端口，然后与服务器的相应端口联系。


传输层主要是建立**端口到端口**的通信，因此只要确定主机和端口，就能实现程序之间的交流。

- UDP协议：标头和数据两部分组成，标头定义了发出端口和接收端口，数据部分就是具体的内容。把整个UDP数据包放入IP数据包的数据部分。IP数据包又是放在以太网数据包之中。不可靠的。<br />
以太网数据包如下(绿色部分是UDP协议部分)
![以太网数据包](./assets/UDP.png)

- TCP协议：面向连接，可靠的，基于字节流的传输层通信协议，把上面应用层交下来的数据看成无结构的字节流发送，保证了数据的可靠性。

![UDP和TCP区别](./assets/TCP%E4%B8%8EUDP%E5%8C%BA%E5%88%AB.png)

### 4.应用层
应用程序收到传输层的数据需要进行解读，应用层作用就是规定应用程序的数据格式

TCP协议可以为各种各样的程序传递数据，比如Email、WWW、FTP等等。那么，必须有不同协议规定电子邮件、网页、FTP数据的格式，这些应用程序协议就构成了"应用层"。
